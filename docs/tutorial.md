# PyPEEC - Getting Started

## Tools

The **PyPEEC** package contains the following tools (`PyPEEC` package)::
* **mesher** (`PyPEEC.mesher` module)
  * Create the voxel structure (from STL or PNG files)
  * Assign different domain names to the voxels
  * Resampling (refine) the voxel structure
  * Construct the graph of the structure and detect connected components
* **viewer** (`PyPEEC.viewer` module)
  * Visualization of the different domains composing the voxel structure
  * Visualization of the connected components composing the voxel structure
* **solver** (`PyPEEC.solver` module)
  * Computation of the incidence matrix
  * Computation of the Green tensors
  * Computation of the resistance and inductance matrices
  * Assemble the equation system
  * Extract of a sparse pre-conditioner
  * Extract a matrix-vector linear operator for the full system
  * Check the condition number of the system
  * Solve the equation system with the pre-conditioner and the linear operator
  * Extract the solution (terminal voltages and currents, voxel potential, and voxel current density)
* **plotter** (`PyPEEC.plotter` module)
    * Plot the material description (conductors and sources)
    * Plot the potential and current density of the different voxels
    * Plot the magnetic field generated by the conductors

## Workflow

![viewer](images/workflow.png)

## Script and File Description

The entry points of the different tools are located in the `PyPEEC.script` module.
Additionally, the Python package is defining the following console scripts:
* `ppmesher` for the **mesher**
* `ppviewer` for the **viewer**
* `ppsolver` for the **solver**
* `ppplotter` for the **plotter**

The following files (JSON for inputs, pickle for outputs) are used:
* `file_mesher` (JSON, input file): description of the geometry
* `file_problem` (JSON, input file): description of the magnetic problem
* `file_point` (JSON, input file): definition of a point cloud for evaluating the magnetic field
* `file_viewer` (JSON, input file): options for the plots generated by the viewer
* `file_plotter` (JSON, input file): options for the plots generated by the plotter
* `file_voxel` (Pickle, output file): file with the definition of the voxel structure
* `file_solution` (Pickle, output file): file with the solution of the magnetic problem

## Examples

Different examples are located in the `examples` folder:
* **stl_inductor**: a 3D inductor created from STL files
* **stl_transformer**: a planar transformer created from STL files
* **png_inductor**: a planar inductor created from PNG files
* **png_shield**: a conductor loop with a magnetic shield created from PNG files
* **png_busbar**: a coplanar busbar (L-shaped) created from PNG files
* **png_wire**: a straight wire created from PNG files
* **png_pcb**: simple PCB traces created from PNG files
* **voxel_slab**: a simple slab conductor in free space
* **voxel_core**: a simple slab conductor surrounded by a magnetic core
* **voxel_transformer**: a simple transformer

The following files (located in the `examples` folder) are used to run the examples.
* `run_visualization.py` is used to generate the configuration file for the viewer/plotter
* `examples_config.py` is used to select the example (when using the Python launchers)
* `examples_config.sh` is used to select the example (when using the Shell launchers)
* `run_mesher.[py/sh]` is the launcher for the mesher (Python or Shell)
* `run_viewer.[py/sh]` is the viewer for the mesher (Python or Shell)
* `run_solver.[py/sh]` is the solver for the mesher (Python or Shell)
* `run_plotter.[py/sh]` is the plotter for the mesher (Python or Shell)
