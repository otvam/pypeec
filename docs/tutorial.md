# PyPEEC - Getting Started

## Tools

The **PyPEEC** package contains the following tools (`pypeec` package)::
* **mesher** (`pypeec.mesher` module)
  * Create the voxel structure (from STL or PNG files)
  * Assign different domain names to the voxels
  * Resampling (refine) the voxel structure
  * Construct the graph of the structure and detect connected components
* **viewer** (`pypeec.viewer` module)
  * Visualization of the different domains composing the voxel structure
  * Visualization of the connected components composing the voxel structure
* **solver** (`pypeec.solver` module)
  * Computation of the incidence matrix
  * Computation of the Green and coupling tensors
  * Computation of the resistance, inductance, and potential matrices
  * Computation of the electric-magnetic coupling matrices
  * Creation of the equation system
  * Extraction of a sparse pre-conditioner
  * Extraction of a matrix-vector linear operator for the full system
  * Check the condition number of the system
  * Solve the equation system with the pre-conditioner and the linear operator
  * Extract the solution (terminal voltages and currents, scalar fields, and vector fields)
* **plotter** (`pypeec.plotter` module)
    * Plot the material description (materials and sources)
    * Plot the scalar and vector fields of the different voxels
    * Plot the magnetic field generated by the voxels

## Workflow

![viewer](images/workflow.png)

## Entry Points and Scripts

The entry points of the different tools are located in the `pypeec.main` module:
* `run_mesher` for running the **mesher**
* `run_viewer` for running the **viewer**
* `run_solver` for running the **solver**
* `run_plotter` for running the **plotter**

Additionally, a command line tool is located in the `pypeec.script` module:
* `pypeec --help` for displaying the command line options
* `pypeec mesher` for running the **mesher**
* `pypeec viewer` for running the **viewer**
* `pypeec solver` for running the **solver**
* `pypeec plotter` for running the **plotter**

## Input/Output File Description

The following input files (JSON or YAML format) are used:
* `file_mesher` (JSON or YAML, input file): description of the geometry
* `file_problem` (JSON or YAML, input file): description of the magnetic problem
* `file_tolerance` (JSON or YAML, input file): description of the solver numerical options
* `file_point` (JSON or YAML, input file): definition of a point cloud for evaluating the magnetic field
* `file_viewer` (JSON or YAML, input file): options for the plots generated by the viewer
* `file_plotter` (JSON or YAML, input file): options for the plots generated by the plotter

The following files (Pickle format) are generated:
* `file_voxel` (Pickle, output file): file with the definition of the voxel structure
* `file_solution` (Pickle, output file): file with the solution of the magnetic problem

## Definition of the Example Problems

Different examples are located in the `examples` folder:
* voxel structure generated from STL files
  * **stl_inductor_air**: a 3D air-core inductor
  * **stl_inductor_core**: a 3D inductor with a magnetic E-core core
  * **stl_transformer**: a planar transformer with two windings
* voxel structure generated from PNG files
  * **png_inductor_spiral**: a planar spiral inductor
  * **png_inductor_spiral**: a gapped inductor with an E-core
  * **png_shield**: a conductor loop with a magnetic shield
  * **png_busbar**: a coplanar L-shaped busbar
  * **png_wire**: a straight round wire
  * **png_pcb**: a PCB with traces
* voxel structure created from voxel indices
  * **voxel_slab**: a simple slab conductor in free space
  * **voxel_core**: a simple slab conductor surrounded by a magnetic core
  * **voxel_transformer**: a simple coil with a secondary short-circuit winding
  * **voxel_logo**: a simple geometry used for the PyPEEC logo

## Running the Example Problems

The following files (located in the `examples` folder) are used to run the examples.
* `run_config.py` is used to regenerate the configuration files
* `notebook.ipynb` for running the example from a Jupyter notebook
* for running the examples from Python
  * `examples_config.py` is used to select the example
  * `run_mesher.py` runs the mesher
  * `run_viewer.py` runs the viewer
  * `run_solver.py` runs the solver
  * `run_plotter.py` runs the plotter
* for running the examples from the Shell
  * `examples_config.sh` is used to select the example
  * `run_mesher.sh` runs the mesher
  * `run_viewer.sh` runs the viewer
  * `run_solver.sh` runs the solver
  * `run_plotter.sh` runs the plotter
